<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <meta name="robots" content="noindex, nofollow" />
  <title>Stuffolio Beta Testing Guide ‚Äî v1.0 (Build 18)</title>

  <style>
    :root{
      --primary:#007AFF;
      --secondary:#5856D6;
      --success:#34C759;
      --warning:#FF9500;
      --danger:#FF3B30;
      --beta:#AF52DE;
      --background:#f5f5f7;
      --card-bg:#ffffff;
      --text:#1d1d1f;
      --text-secondary:#86868b;
      --border:#d2d2d7;
    }
    @media (prefers-color-scheme: dark){
      :root:not([data-theme="light"]){
        --background:#1d1d1f;
        --card-bg:#2d2d2d;
        --text:#f5f5f7;
        --text-secondary:#a1a1a6;
        --border:#424245;
      }
    }
    [data-theme="dark"]{
      --background:#1d1d1f;
      --card-bg:#2d2d2d;
      --text:#f5f5f7;
      --text-secondary:#a1a1a6;
      --border:#424245;
    }

    *{margin:0;padding:0;box-sizing:border-box}
    body{
      font-family:-apple-system,BlinkMacSystemFont,'SF Pro Text','Segoe UI',Roboto,sans-serif;
      background:var(--background);
      color:var(--text);
      line-height:1.6;
    }

    /* Beta Banner */
    .beta-banner{
      background:linear-gradient(135deg,var(--beta),var(--primary));
      color:#fff;
      text-align:center;
      padding:12px 20px;
      font-weight:700;
      position:sticky;
      top:0;
      z-index:1000;
      box-shadow:0 2px 12px rgba(175,82,222,.3);
    }
    .beta-banner span{
      background:rgba(255,255,255,.2);
      padding:4px 12px;
      border-radius:12px;
      font-size:.85em;
      margin-left:12px;
      font-weight:700;
    }

    /* Navigation (keep existing links) */
    .site-nav{
      background:var(--card-bg);
      border-bottom:1px solid var(--border);
      padding:12px 20px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      flex-wrap:wrap;
      gap:12px;
    }
    .site-nav .site-title{
      font-weight:800;
      font-size:1.2em;
      color:var(--text);
      text-decoration:none;
    }
    .site-nav nav{display:flex;gap:16px;flex-wrap:wrap}
    .site-nav nav a{
      color:var(--text-secondary);
      text-decoration:none;
      font-size:.9em;
      transition:color .2s;
    }
    .site-nav nav a:hover{color:var(--primary)}
    .site-nav nav a[aria-current="page"]{color:var(--primary);font-weight:700}

    /* Theme Toggle */
    .theme-toggle{
      display:flex;
      align-items:center;
      gap:8px;
      background:transparent;
      padding:0;
      border:none;
    }
    .theme-toggle-switch{
      position:relative;
      width:50px;
      height:26px;
      background:var(--border);
      border-radius:13px;
      cursor:pointer;
      transition:background .3s;
      outline:none;
    }
    .theme-toggle-switch::before{
      content:'';
      position:absolute;
      top:3px;left:3px;
      width:20px;height:20px;
      background:#fff;
      border-radius:50%;
      transition:transform .3s;
      box-shadow:0 2px 4px rgba(0,0,0,.2);
    }
    .theme-toggle-switch.dark{background:var(--primary)}
    .theme-toggle-switch.dark::before{transform:translateX(24px)}
    .theme-icon{font-size:1.05em}

    /* Main Content */
    .main-content{
      max-width:860px;
      margin:0 auto;
      padding:40px 20px;
    }

    /* Tester CTA */
    .tester-cta{text-align:center;margin-bottom:24px}
    .tester-cta p{color:var(--text-secondary);margin-bottom:12px;font-size:.95em}
    .tester-badge{
      display:inline-flex;
      align-items:center;
      gap:10px;
      background:linear-gradient(135deg,var(--beta),var(--primary));
      color:#fff;
      padding:12px 20px;
      border-radius:12px;
      text-decoration:none;
      font-weight:800;
      transition:all .2s;
      box-shadow:0 4px 12px rgba(175,82,222,.3);
    }
    .tester-badge:hover{
      transform:translateY(-2px);
      box-shadow:0 6px 16px rgba(175,82,222,.4);
    }
    .tester-badge .icon{font-size:1.25em}

    /* Header */
    header{text-align:center;margin-bottom:32px}
    header h1{font-size:2.2em;margin-bottom:8px}
    header .version{color:var(--text-secondary);font-size:1.1em}
    header .platforms{
      display:flex;justify-content:center;gap:12px;margin-top:16px;flex-wrap:wrap
    }
    header .platform-badge{
      background:var(--card-bg);
      padding:8px 16px;
      border-radius:8px;
      font-size:.9em;
      border:1px solid var(--border);
    }

    /* Cards */
    .card{
      background:var(--card-bg);
      border-radius:16px;
      padding:28px;
      margin-bottom:24px;
      border:1px solid var(--border);
    }
    .card h2{
      font-size:1.4em;
      margin-bottom:8px;
      display:flex;
      align-items:center;
      gap:12px;
    }
    .card .subtitle{color:var(--text-secondary);margin-bottom:18px}

    /* Welcome Card */
    .welcome-card{
      background:linear-gradient(135deg,var(--beta),var(--primary));
      color:#fff;border-radius:16px;padding:32px;margin-bottom:24px;text-align:center;
    }
    .welcome-card h2{font-size:1.6em;margin-bottom:12px}
    .welcome-card p{opacity:.95;font-size:1.1em;line-height:1.6;max-width:640px;margin:0 auto}
    .welcome-card .philosophy{
      margin-top:20px;padding-top:20px;border-top:1px solid rgba(255,255,255,.2);
      font-size:1em;opacity:.9;
    }

    /* Priority Badge */
    .priority-badge{
      background:linear-gradient(135deg,var(--success),#2db44c);
      color:#fff;padding:3px 10px;border-radius:10px;font-size:.7em;font-weight:800;
      text-transform:uppercase;letter-spacing:.5px
    }

    /* Priority Grid */
    .priority-grid{display:grid;gap:16px}
    .priority-item{
      background:var(--background);
      border-radius:12px;
      padding:20px;
      border-left:4px solid var(--success);
    }
    .priority-item h3{
      font-size:1.1em;margin-bottom:6px;
      display:flex;align-items:center;gap:10px;flex-wrap:wrap;
    }
    .priority-item h3 .badge{
      background:var(--beta);
      color:#fff;font-size:.65em;padding:2px 8px;border-radius:8px;font-weight:800;
    }
    .priority-item p{color:var(--text-secondary);font-size:.95em;margin-bottom:10px}
    .priority-item .why{font-size:.85em;color:var(--success);font-style:italic}

    /* Scenarios */
    .scenario-grid{display:grid;gap:16px}
    .scenario-item{
      background:var(--background);
      border-radius:12px;
      padding:20px;
      position:relative;
    }
    .scenario-item::before{
      content:attr(data-number);
      position:absolute;top:-10px;left:20px;
      background:var(--primary);color:#fff;width:28px;height:28px;border-radius:50%;
      display:flex;align-items:center;justify-content:center;font-weight:900;font-size:.9em;
    }
    .scenario-item h3{font-size:1.05em;margin-bottom:8px;margin-top:8px}
    .scenario-item p{color:var(--text-secondary);font-size:.95em;margin-bottom:12px}
    .scenario-item .exercises{
      font-size:.85em;color:var(--text);
      background:var(--card-bg);
      padding:12px;border-radius:8px;
      border:1px solid var(--border);
    }
    .scenario-item .exercises strong{color:var(--primary)}

    /* Feedback */
    .feedback-grid{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
      gap:16px;
      margin-bottom:24px;
    }
    .feedback-option{
      background:var(--background);
      border-radius:12px;
      padding:24px;
      text-align:center;
      text-decoration:none;
      color:var(--text);
      transition:all .2s;
      border:2px solid transparent;
      cursor:pointer;
      user-select:none;
    }
    .feedback-option:hover{border-color:var(--primary);transform:translateY(-2px)}
    .feedback-option:focus{outline:3px solid rgba(0,122,255,.35);outline-offset:3px}
    .feedback-option .icon{font-size:2.5em;margin-bottom:12px}
    .feedback-option h3{font-size:1.1em;margin-bottom:6px}
    .feedback-option p{font-size:.85em;color:var(--text-secondary)}
    .feedback-option.primary{
      background:linear-gradient(135deg,rgba(0,122,255,.1),rgba(88,86,214,.1));
      border-color:var(--primary);
    }

    .template-box{
      background:var(--background);
      border-radius:12px;
      padding:20px;
      margin-top:20px;
    }
    .template-box h4{
      font-size:.95em;margin-bottom:12px;display:flex;align-items:center;gap:8px
    }
    .template-content{
      background:var(--card-bg);
      border:1px solid var(--border);
      border-radius:8px;
      padding:16px;
      font-family:'SF Mono',Monaco,monospace;
      font-size:.85em;
      white-space:pre-line;
      margin-bottom:12px;
    }
    .copy-btn{
      background:var(--primary);
      color:#fff;border:none;
      padding:10px 20px;border-radius:8px;
      cursor:pointer;font-size:.9em;font-weight:800;
      transition:all .2s;
    }
    .copy-btn:hover{filter:brightness(.95)}
    .copy-btn.copied{background:var(--success)}

    .info-box{
      background:rgba(0,122,255,.1);
      border-left:4px solid var(--primary);
      padding:14px;border-radius:0 8px 8px 0;
      margin:14px 0;
      font-size:.9em;
    }
    .info-box.warning{
      background:rgba(255,149,0,.1);
      border-left-color:var(--warning);
    }
    .info-box strong{display:block;margin-bottom:4px}

    /* Expandable Checklist */
    .expand-section{
      background:linear-gradient(135deg,rgba(0,122,255,.08),rgba(88,86,214,.08));
      border:2px solid var(--primary);
      border-radius:16px;
      margin-top:28px;
      padding:28px;
      text-align:center;
    }
    .expand-header{
      display:flex;align-items:center;justify-content:center;gap:12px;margin-bottom:12px;
    }
    .expand-header .icon{font-size:1.8em}
    .expand-header h3{font-size:1.3em;margin:0}
    .expand-prompt{color:var(--text-secondary);margin-bottom:20px;font-size:1em}
    .expand-btn{
      background:linear-gradient(135deg,var(--primary),var(--secondary));
      color:#fff;border:none;
      padding:16px 32px;border-radius:12px;
      cursor:pointer;font-size:1.05em;font-weight:900;
      transition:all .2s;
      display:inline-flex;align-items:center;gap:10px;
      box-shadow:0 4px 12px rgba(0,122,255,.3);
    }
    .expand-btn:hover{
      transform:translateY(-2px);
      box-shadow:0 6px 16px rgba(0,122,255,.4);
    }
    .expand-btn .arrow{transition:transform .3s}
    .expand-btn.expanded .arrow{transform:rotate(180deg)}
    .expand-badge{
      display:inline-block;background:var(--success);color:#fff;font-size:.75em;
      padding:4px 10px;border-radius:12px;margin-top:16px;font-weight:900;
    }

    .full-checklist{display:none;margin-top:28px;text-align:left}
    .full-checklist.visible{display:block}

    .progress-card{
      background:linear-gradient(135deg,var(--beta),var(--primary));
      color:#fff;border-radius:16px;padding:24px;margin-bottom:24px;
      box-shadow:0 4px 20px rgba(175,82,222,.3);
    }
    .progress-card h3{font-size:1.2em;margin-bottom:8px}
    .progress-card p{opacity:.9;margin-bottom:16px;font-size:.95em}
    .progress-bar-container{
      background:rgba(255,255,255,.2);
      border-radius:8px;height:12px;overflow:hidden;margin-bottom:8px;
    }
    .progress-bar{
      height:100%;
      background:#fff;
      border-radius:8px;
      transition:width .5s ease;
    }
    .progress-stats{display:flex;justify-content:space-between;font-size:.9em;gap:12px;flex-wrap:wrap}
    .reset-btn{
      background:rgba(255,255,255,.2);
      color:#fff;border:none;
      padding:8px 16px;border-radius:8px;cursor:pointer;font-size:.85em;
      margin-top:12px;transition:background .2s;
    }
    .reset-btn:hover{background:rgba(255,255,255,.3)}

    /* Sections */
    .section{
      background:var(--card-bg);
      border-radius:16px;
      padding:24px;
      margin-bottom:20px;
      border:1px solid var(--border);
    }
    .section-header{
      display:flex;align-items:center;gap:12px;margin-bottom:16px;
      cursor:pointer;user-select:none;
    }
    .section-header:focus{outline:3px solid rgba(0,122,255,.35);outline-offset:3px;border-radius:12px}
    .section-header h3{flex:1;font-size:1.15em}
    .section-icon{
      width:36px;height:36px;background:var(--background);
      border-radius:10px;display:flex;align-items:center;justify-content:center;
      font-size:1.1em;
    }
    .section-toggle{
      width:28px;height:28px;background:var(--background);
      border-radius:8px;display:flex;align-items:center;justify-content:center;
      transition:transform .3s;font-size:.9em;
    }
    .section.collapsed .section-toggle{transform:rotate(-90deg)}
    .section.collapsed .section-content{display:none}
    .section-progress{
      font-size:.8em;color:var(--text-secondary);
      background:var(--background);padding:4px 10px;border-radius:12px;
      white-space:nowrap;
    }
    .section-progress.complete{
      background:rgba(52,199,89,.15);
      color:var(--success);
      font-weight:800;
    }
    .sprint-badge{
      background:var(--beta);
      color:#fff;padding:2px 8px;border-radius:10px;font-size:.7em;font-weight:900;
      white-space:nowrap;
    }
    .sprint-badge.new{background:var(--success)}

    /* Checklist Items */
    .checklist{list-style:none}
    .checklist-item{
      display:flex;align-items:flex-start;gap:12px;
      padding:10px 0;border-bottom:1px solid var(--border);
    }
    .checklist-item:last-child{border-bottom:none}
    .checklist-item input[type="checkbox"]{
      width:20px;height:20px;margin-top:2px;accent-color:var(--primary);cursor:pointer;
    }
    .checklist-item label{flex:1;cursor:pointer;font-size:.95em}
    .checklist-item.checked label{color:var(--text-secondary);text-decoration:line-through}

    .subsection{margin-top:16px;padding-top:12px;border-top:1px solid var(--border)}
    .subsection h4{font-size:1em;margin-bottom:10px;color:var(--primary)}

    /* Tables & kbd */
    table{width:100%;border-collapse:collapse;margin:12px 0;font-size:.85em}
    th,td{padding:10px;text-align:left;border-bottom:1px solid var(--border)}
    th{background:var(--background);font-weight:800}
    kbd{
      background:var(--background);
      border:1px solid var(--border);
      border-radius:4px;
      padding:2px 6px;
      font-family:'SF Mono',Monaco,monospace;
      font-size:.85em;
    }

    /* Thank You */
    .thank-you-card{
      background:linear-gradient(135deg,#34C759,#2db44c);
      color:#fff;border-radius:16px;padding:32px;text-align:center;margin-top:28px;
    }
    .thank-you-card h2{font-size:1.6em;margin-bottom:12px}
    .thank-you-card p{opacity:.95;font-size:1.05em}

    footer{text-align:center;padding:24px;color:var(--text-secondary);font-size:.85em}

    /* Mobile tweaks */
    @media (max-width: 600px){
      .main-content{padding:20px 16px}
      .site-nav{padding:10px 16px}
      .site-nav nav{gap:12px}
      .site-nav nav a{font-size:.85em}
      header h1{font-size:1.8em}
      .welcome-card{padding:24px 20px}
      .card{padding:20px}
      .feedback-grid{grid-template-columns:1fr}
    }
  </style>
</head>

<body>
  <div class="beta-banner">
    TestFlight Beta Testing <span>v1.0 Build 18</span>
  </div>

  <!-- Navigation (unchanged links) -->
  <div class="site-nav">
    <a href="index.html" class="site-title">Stuffolio</a>
    <nav>
      <a href="index.html">Home</a>
      <a href="quick-start.html">Quick Start</a>
      <a href="features.html">Features</a>
      <a href="beta-testing-guide.html" aria-current="page">Testing Guide</a>
      <a href="support.html">Support</a>
    </nav>
    <div class="theme-toggle" aria-label="Theme toggle">
      <span class="theme-icon" aria-hidden="true">‚òÄÔ∏è</span>
      <div class="theme-toggle-switch" id="themeSwitch" role="switch" aria-checked="false" tabindex="0"></div>
      <span class="theme-icon" aria-hidden="true">üåô</span>
    </div>
  </div>

  <main class="main-content">
    <!-- Become a Tester CTA -->
    <div class="tester-cta">
      <p>Not a beta tester yet?</p>
      <a href="https://testflight.apple.com/join/TWgM95st" class="tester-badge">
        <span class="icon" aria-hidden="true">üß™</span>
        <span>Join the Beta on TestFlight</span>
      </a>
    </div>

    <!-- Header -->
    <header>
      <h1>Beta Testing Guide</h1>
      <p class="version">Stuffolio v1.0 (Build 18) ‚Äî January 2026</p>
      <div class="platforms">
        <span class="platform-badge">üì± iOS 17.6+</span>
        <span class="platform-badge">üì± iPadOS 17.6+</span>
        <span class="platform-badge">üíª macOS 14.6+</span>
      </div>
    </header>

    <!-- Welcome Card -->
    <div class="welcome-card">
      <h2>Welcome, Beta Tester!</h2>
      <p>Thanks for helping make Stuffolio better. There‚Äôs no pressure to test everything ‚Äî explore what interests you and tell us what you find.</p>
      <div class="philosophy">
        <strong>The Stuffolio way:</strong> Do as much or as little as feels right. Your real-world feedback matters more than checking every box.
      </div>
    </div>

    <!-- Priority Features (refocused to Build 18) -->
    <div class="card">
      <h2><span class="icon" aria-hidden="true">üéØ</span> Priority Testing <span class="priority-badge">Build 18 Focus</span></h2>
      <p class="subtitle">If you only test a few things, please focus here. These areas are the most new/complex in this build.</p>

      <div class="priority-grid">
        <div class="priority-item">
          <h3>‚ú® Stuff Scout Refinement <span class="badge">NEW</span></h3>
          <p>Re-analyze existing items from the Edit view. Compare Scout's findings with current values and selectively apply updates.</p>
          <div class="why">Why it matters: This lets users enhance their existing inventory with AI ‚Äî a key workflow improvement.</div>
        </div>

        <div class="priority-item">
          <h3>üß¨ Legacy Wishes in Edit Item <span class="badge">NEW</span></h3>
          <p>Assign items to beneficiaries directly from the Edit Item view without leaving the form.</p>
          <div class="why">Why it matters: Streamlines the "who gets what" workflow ‚Äî one less navigation step.</div>
        </div>

        <div class="priority-item">
          <h3>üì± iPad UI & Layout Polish <span class="badge">Critical</span></h3>
          <p>Sheet sizing, form readability, hover + context menus, and navigation behavior across iPad orientations and window sizes.</p>
          <div class="why">Why it matters: A lot changed here ‚Äî we want iPad to feel "native" and rock-solid.</div>
        </div>

        <div class="priority-item">
          <h3>üîó Clickable Source Links <span class="badge">New</span></h3>
          <p>Recent Sales in Stuff Scout results now have clickable marketplace links (eBay, Etsy, etc.) when available.</p>
          <div class="why">Why it matters: Users can verify pricing sources and explore comparable sales.</div>
        </div>
      </div>
    </div>

    <!-- Legacy Wishes Card -->
    <div class="card">
      <h2><span class="icon" aria-hidden="true">üß¨</span> Legacy Wishes ‚Äî What to Test</h2>
      <p class="subtitle">Legacy Wishes helps you record who should get what (informational only ‚Äî not legal estate planning).</p>

      <div class="info-box">
        <strong>Focus on clarity</strong>
        Does it feel respectful, understandable, and easy to update? If anything is confusing, that‚Äôs the most valuable feedback.
      </div>

      <ul style="margin-left:18px; color: var(--text-secondary);">
        <li>Create a beneficiary (and edit/delete one).</li>
        <li>Assign a few items to a beneficiary.</li>
        <li>Remove an assignment and confirm the UI updates everywhere.</li>
        <li>Check the Legacy Wishes entry points: sidebar + item detail view.</li>
        <li>Try exporting/sharing summaries if available, and judge readability.</li>
      </ul>
    </div>

    <!-- New & Updated Features -->
    <div class="card">
      <h2><span class="icon" aria-hidden="true">‚ú®</span> New & Updated Features</h2>
      <p class="subtitle">These are great areas to explore after the priority items above.</p>

      <div class="priority-grid" style="gap:14px;">
        <div class="priority-item" style="border-left-color: var(--primary);">
          <h3>üóÇÔ∏è Gallery, List, and Cards (My Products)</h3>
          <p>Switch between List / Gallery / Cards and confirm the selected view is clear, consistent, and performant with larger inventories.</p>
          <div class="why" style="color: var(--primary);">Tip: Try after applying filters + search.</div>
        </div>

        <div class="priority-item" style="border-left-color: var(--primary);">
          <h3>üè∑Ô∏è Multi-Category Support (Up to 5)</h3>
          <p>Use the chip-based picker to assign multiple categories and confirm items appear in all relevant groupings.</p>
          <div class="why" style="color: var(--primary);">Tip: Try one item that truly fits 2‚Äì3 categories.</div>
        </div>

        <div class="priority-item" style="border-left-color: var(--primary);">
          <h3>üßæ Receipt Pairing + Auto-Fill</h3>
          <p>Add a receipt after Stuff Scout identifies a product, then test Auto-fill from receipt on an existing item (fills blanks only).</p>
          <div class="why" style="color: var(--primary);">Tip: Test a crumpled or low-light receipt.</div>
        </div>

        <div class="priority-item" style="border-left-color: var(--primary);">
          <h3>üì∏ Photo Quality Checks (Identification & OCR)</h3>
          <p>Try low light, blurry, and small-text photos and see if the guidance is accurate and helpful.</p>
          <div class="why" style="color: var(--primary);">Tip: Evaluate whether warnings feel ‚Äúsmart‚Äù or annoying.</div>
        </div>

        <div class="priority-item" style="border-left-color: var(--primary);">
          <h3>üñºÔ∏è Image Handling Improvements</h3>
          <p>Thumbnail priority (Product ‚Üí Nameplate ‚Üí Receipt) and images section auto-expand behavior.</p>
          <div class="why" style="color: var(--primary);">Tip: Attach both product photos and receipts to the same item.</div>
        </div>
      </div>
    </div>

    <!-- Scenarios -->
    <div class="card">
      <h2><span class="icon" aria-hidden="true">üé¨</span> Try These Scenarios</h2>
      <p class="subtitle">Real-world tasks that naturally exercise multiple features.</p>

      <div class="scenario-grid">
        <div class="scenario-item" data-number="1">
          <h3>The New Purchase</h3>
          <p>You just bought a blender. Add it with a photo, attach the receipt, set warranty dates, and test view modes.</p>
          <div class="exercises"><strong>Exercises:</strong> Photos, receipt OCR, warranty tracking, My Products view modes</div>
        </div>

        <div class="scenario-item" data-number="2">
          <h3>The Mystery Item</h3>
          <p>Use Stuff Scout to identify an item, then leave the app while it processes in the background.</p>
          <div class="exercises"><strong>Exercises:</strong> Background processing, notifications, results navigation</div>
        </div>

        <div class="scenario-item" data-number="3">
          <h3>The ‚ÄúWho Gets What‚Äù Pass</h3>
          <p>Create two beneficiaries and assign 3‚Äì5 items. Then change your mind and move one item to a different person.</p>
          <div class="exercises"><strong>Exercises:</strong> Legacy Wishes creation, assignments, edits, removal</div>
        </div>

        <div class="scenario-item" data-number="4">
          <h3>The iPad Power User</h3>
          <p>On iPad with keyboard/trackpad: resize the window, open several sheets, use context menus, and try drag & drop of images from another app.</p>
          <div class="exercises"><strong>Exercises:</strong> iPad layout, sheets, hover, context menus, drag & drop</div>
        </div>

        <div class="scenario-item" data-number="5">
          <h3>The Multi-Device Edit</h3>
          <p>Edit an item on iPhone, then continue on iPad or Mac. Check whether the latest changes appear quickly and consistently.</p>
          <div class="exercises"><strong>Exercises:</strong> Sync, editing, list/detail consistency</div>
        </div>
      </div>
    </div>

    <!-- Feedback -->
    <div class="card">
      <h2><span class="icon" aria-hidden="true">üí¨</span> Send Us Feedback</h2>
      <p class="subtitle">Found a bug? Have a suggestion? Here‚Äôs how to reach us.</p>

      <div class="feedback-grid">
        <a class="feedback-option primary"
           href="mailto:dev@stuffolio.app?subject=Stuffolio%20Beta%20Feedback%20-%20v1.0%20(Build%2018)&body=%0A%0A---%0AWhat%20I%20tested%3A%0A%0AWhat%20happened%3A%0A%0AWhat%20I%20expected%3A%0A%0ADevice%3A%0AiOS%2FmacOS%20Version%3A%0A">
          <div class="icon" aria-hidden="true">üìß</div>
          <h3>Email Us</h3>
          <p>dev@stuffolio.app<br />Pre-filled template ready</p>
        </a>

        <div class="feedback-option" onclick="showTestFlightTip()" role="button" tabindex="0">
          <div class="icon" aria-hidden="true">üì≤</div>
          <h3>TestFlight</h3>
          <p>Shake your device or<br />screenshot to report</p>
        </div>

        <div class="feedback-option" onclick="copyTemplate()" role="button" tabindex="0">
          <div class="icon" aria-hidden="true">üìã</div>
          <h3>Copy Template</h3>
          <p>Get a feedback template<br />to paste anywhere</p>
        </div>
      </div>

      <div class="template-box" id="templateBox" style="display:none;">
        <h4>üìã Feedback Template</h4>
        <div class="template-content" id="templateContent">Stuffolio Beta Feedback - v1.0 (Build 18)

What I tested:
[Describe the feature or scenario]

What happened:
[Describe the actual behavior]

What I expected:
[Describe what should have happened]

Device: [iPhone / iPad / Mac]
OS Version: [iOS / iPadOS / macOS version]

Additional notes:
[Steps to reproduce, screenshots, etc.]</div>
        <button class="copy-btn" id="copyBtn" onclick="copyToClipboard()">Copy to Clipboard</button>
      </div>

      <div class="info-box" id="testflightTip" style="display:none;">
        <strong>TestFlight Feedback Tips</strong>
        <ul style="margin: 8px 0 0 20px; font-size: 0.9em;">
          <li><strong>Shake your device</strong> while in the app to open the feedback form</li>
          <li><strong>Take a screenshot</strong> ‚Äî TestFlight will ask if you want to send feedback</li>
          <li>TestFlight automatically includes device info and crash logs</li>
        </ul>
      </div>
    </div>

    <!-- Expand Section -->
    <div class="expand-section">
      <div class="expand-header">
        <span class="icon" aria-hidden="true">üìã</span>
        <h3>Complete Testing Checklist</h3>
      </div>
      <p class="expand-prompt">Optional! Track your progress with an interactive checklist ‚Äî progress saves locally in your browser.</p>
      <button class="expand-btn" id="expandBtn" onclick="toggleFullChecklist()">
        <span>Show Complete Checklist</span>
        <span class="arrow" aria-hidden="true">‚ñº</span>
      </button>
      <div class="expand-badge">‚úì Progress Saved Locally</div>
    </div>

    <!-- Full Checklist -->
    <div class="full-checklist" id="fullChecklist">
      <div class="progress-card">
        <h3>Your Testing Progress</h3>
        <p>This is optional! Only for testers who want to track everything.</p>
        <div class="progress-bar-container">
          <div class="progress-bar" id="progressBar" style="width:0%"></div>
        </div>
        <div class="progress-stats">
          <span id="progressText">0 of 0 items completed</span>
          <span id="progressPercent">0%</span>
        </div>
        <button class="reset-btn" onclick="resetProgress()">Reset Progress</button>
      </div>

      <!-- Core -->
      <section class="section" id="core-features" data-section="core-features">
        <div class="section-header" onclick="toggleSection(this.parentElement)" tabindex="0" role="button" aria-expanded="true">
          <div class="section-icon">üì¶</div>
          <h3>Core Features</h3>
          <span class="section-progress">0/0</span>
          <div class="section-toggle">‚ñº</div>
        </div>
        <div class="section-content">
          <ul class="checklist">
            <li class="checklist-item"><input type="checkbox" id="core-1"><label for="core-1">Add an item using the ‚Äú+‚Äù button</label></li>
            <li class="checklist-item"><input type="checkbox" id="core-2"><label for="core-2">Add an item via barcode scanner</label></li>
            <li class="checklist-item"><input type="checkbox" id="core-3"><label for="core-3">Search for items by name</label></li>
            <li class="checklist-item"><input type="checkbox" id="core-4"><label for="core-4">Filter items by category</label></li>
            <li class="checklist-item"><input type="checkbox" id="core-5"><label for="core-5">Edit an existing item</label></li>
            <li class="checklist-item"><input type="checkbox" id="core-6"><label for="core-6">Delete an item</label></li>
            <li class="checklist-item"><input type="checkbox" id="core-7"><label for="core-7">Add photos to an item</label></li>
            <li class="checklist-item"><input type="checkbox" id="core-8"><label for="core-8">Set warranty dates</label></li>
          </ul>
        </div>
      </section>

      <!-- New Features (Build 18 Priority) -->
      <section class="section" id="new-features" data-section="new-features">
        <div class="section-header" onclick="toggleSection(this.parentElement)" tabindex="0" role="button" aria-expanded="true">
          <div class="section-icon">‚ú®</div>
          <h3>New Features (Build 18)</h3>
          <span class="sprint-badge new">Priority</span>
          <span class="section-progress">0/0</span>
          <div class="section-toggle">‚ñº</div>
        </div>

        <div class="section-content">
          <div class="subsection">
            <h4>üß¨ Legacy Wishes</h4>
            <ul class="checklist">
              <li class="checklist-item"><input type="checkbox" id="legacy-1"><label for="legacy-1">Legacy Wishes entry appears in navigation (sidebar / menu)</label></li>
              <li class="checklist-item"><input type="checkbox" id="legacy-2"><label for="legacy-2">Create a beneficiary successfully</label></li>
              <li class="checklist-item"><input type="checkbox" id="legacy-3"><label for="legacy-3">Edit beneficiary details and verify changes persist</label></li>
              <li class="checklist-item"><input type="checkbox" id="legacy-4"><label for="legacy-4">Assign an item to a beneficiary</label></li>
              <li class="checklist-item"><input type="checkbox" id="legacy-5"><label for="legacy-5">Remove an assignment and confirm UI updates everywhere</label></li>
              <li class="checklist-item"><input type="checkbox" id="legacy-6"><label for="legacy-6">Legacy Wishes entry point exists from item detail view</label></li>
              <li class="checklist-item"><input type="checkbox" id="legacy-7"><label for="legacy-7">Export/share summary (if available) is readable and correct</label></li>
            </ul>
          </div>

          <div class="subsection">
            <h4>üß¨ Legacy Wishes in Edit Item (NEW - Build 18)</h4>
            <ul class="checklist">
              <li class="checklist-item"><input type="checkbox" id="legacy-edit-1"><label for="legacy-edit-1">Legacy Wishes section appears in Edit Item form (collapsed)</label></li>
              <li class="checklist-item"><input type="checkbox" id="legacy-edit-2"><label for="legacy-edit-2">Section only visible when Legacy Wishes feature enabled</label></li>
              <li class="checklist-item"><input type="checkbox" id="legacy-edit-3"><label for="legacy-edit-3">Expanding section shows current assignment (if any)</label></li>
              <li class="checklist-item"><input type="checkbox" id="legacy-edit-4"><label for="legacy-edit-4">"Assign This Item" opens assignment sheet</label></li>
              <li class="checklist-item"><input type="checkbox" id="legacy-edit-5"><label for="legacy-edit-5">"Edit Legacy Assignment" for existing assignments</label></li>
              <li class="checklist-item"><input type="checkbox" id="legacy-edit-6"><label for="legacy-edit-6">Status indicator shows when collapsed (checkmark if assigned)</label></li>
            </ul>
          </div>

          <div class="subsection">
            <h4>üì± iPad UI & Layout Polish</h4>
            <ul class="checklist">
              <li class="checklist-item"><input type="checkbox" id="ipadui-1"><label for="ipadui-1">Sheets open at a comfortable size (not cramped)</label></li>
              <li class="checklist-item"><input type="checkbox" id="ipadui-2"><label for="ipadui-2">Forms are readable and not overly wide on iPad</label></li>
              <li class="checklist-item"><input type="checkbox" id="ipadui-3"><label for="ipadui-3">Context menus work (long-press + trackpad)</label></li>
              <li class="checklist-item"><input type="checkbox" id="ipadui-4"><label for="ipadui-4">Hover effects feel consistent with trackpad/mouse</label></li>
              <li class="checklist-item"><input type="checkbox" id="ipadui-5"><label for="ipadui-5">Sidebar navigation behaves correctly in portrait + landscape</label></li>
              <li class="checklist-item"><input type="checkbox" id="ipadui-6"><label for="ipadui-6">Resizing the app window doesn‚Äôt break layouts</label></li>
            </ul>
          </div>

          <div class="subsection">
            <h4>‚ú® Stuff Scout Refinement (NEW - Build 18)</h4>
            <ul class="checklist">
              <li class="checklist-item"><input type="checkbox" id="refine-1"><label for="refine-1">Scout section appears in Edit Item (collapsed by default)</label></li>
              <li class="checklist-item"><input type="checkbox" id="refine-2"><label for="refine-2">Photo count displays correctly in section</label></li>
              <li class="checklist-item"><input type="checkbox" id="refine-3"><label for="refine-3">"Analyze" button disabled when no photos</label></li>
              <li class="checklist-item"><input type="checkbox" id="refine-4"><label for="refine-4">Scout analyzes existing item photos</label></li>
              <li class="checklist-item"><input type="checkbox" id="refine-5"><label for="refine-5">Comparison view shows current vs Scout values</label></li>
              <li class="checklist-item"><input type="checkbox" id="refine-6"><label for="refine-6">Confidence badge displays percentage</label></li>
              <li class="checklist-item"><input type="checkbox" id="refine-7"><label for="refine-7">"NEW" badges appear for newly discovered fields</label></li>
              <li class="checklist-item"><input type="checkbox" id="refine-8"><label for="refine-8">Checkboxes allow selecting which fields to apply</label></li>
              <li class="checklist-item"><input type="checkbox" id="refine-9"><label for="refine-9">"Apply Selected" updates form fields correctly</label></li>
              <li class="checklist-item"><input type="checkbox" id="refine-10"><label for="refine-10">Recent Sales show clickable source links</label></li>
            </ul>
          </div>

          <div class="subsection">
            <h4>üîî Stuff Scout Background Processing</h4>
            <ul class="checklist">
              <li class="checklist-item"><input type="checkbox" id="bg-1"><label for="bg-1">"Process in Background" runs after leaving the app</label></li>
              <li class="checklist-item"><input type="checkbox" id="bg-2"><label for="bg-2">Notification arrives when analysis completes</label></li>
              <li class="checklist-item"><input type="checkbox" id="bg-3"><label for="bg-3">Tapping notification opens the right results</label></li>
              <li class="checklist-item"><input type="checkbox" id="bg-4"><label for="bg-4">Badge count matches unviewed background results</label></li>
              <li class="checklist-item"><input type="checkbox" id="bg-5"><label for="bg-5">Background Results sheet lists pending/completed accurately</label></li>
            </ul>
          </div>

          <div class="subsection">
            <h4>üí≥ Apple Wallet Warranty Cards</h4>
            <ul class="checklist">
              <li class="checklist-item"><input type="checkbox" id="wallet-1"><label for="wallet-1">Wallet section appears for products with warranty dates</label></li>
              <li class="checklist-item"><input type="checkbox" id="wallet-2"><label for="wallet-2">‚ÄúAdd to Wallet‚Äù opens the Wallet sheet</label></li>
              <li class="checklist-item"><input type="checkbox" id="wallet-3"><label for="wallet-3">Pass preview status feels correct (active/expiring/expired)</label></li>
              <li class="checklist-item"><input type="checkbox" id="wallet-4"><label for="wallet-4">Wallet section hides if no warranty date is set</label></li>
            </ul>
          </div>

          <div class="subsection">
            <h4>üõ°Ô∏è AppleCare+ Tracking</h4>
            <ul class="checklist">
              <li class="checklist-item"><input type="checkbox" id="ac-1"><label for="ac-1">AppleCare+ prompt appears for Apple products (where applicable)</label></li>
              <li class="checklist-item"><input type="checkbox" id="ac-2"><label for="ac-2">Blue Care+ badge appears for active AppleCare+ in lists/details</label></li>
              <li class="checklist-item"><input type="checkbox" id="ac-3"><label for="ac-3">Expired AppleCare+ state displays correctly</label></li>
              <li class="checklist-item"><input type="checkbox" id="ac-4"><label for="ac-4">Non-Apple products do not trigger AppleCare+ prompts</label></li>
            </ul>
          </div>

          <div class="subsection">
            <h4>üóÇÔ∏è My Products View Modes</h4>
            <ul class="checklist">
              <li class="checklist-item"><input type="checkbox" id="view-1"><label for="view-1">List / Gallery / Cards toggle is easy to find</label></li>
              <li class="checklist-item"><input type="checkbox" id="view-2"><label for="view-2">Selected mode highlights clearly</label></li>
              <li class="checklist-item"><input type="checkbox" id="view-3"><label for="view-3">Performance remains good with a larger list</label></li>
            </ul>
          </div>

          <div class="subsection">
            <h4>üè∑Ô∏è Multi-Category Support</h4>
            <ul class="checklist">
              <li class="checklist-item"><input type="checkbox" id="multicat-1"><label for="multicat-1">Can select multiple categories up to the limit (5)</label></li>
              <li class="checklist-item"><input type="checkbox" id="multicat-2"><label for="multicat-2">Selected categories show as removable chips</label></li>
              <li class="checklist-item"><input type="checkbox" id="multicat-3"><label for="multicat-3">Item appears in all relevant category groupings</label></li>
            </ul>
          </div>

          <div class="subsection">
            <h4>üßæ Receipt Pairing + Auto-fill</h4>
            <ul class="checklist">
              <li class="checklist-item"><input type="checkbox" id="receipt-1"><label for="receipt-1">Add receipt photo after Stuff Scout identifies a product</label></li>
              <li class="checklist-item"><input type="checkbox" id="receipt-2"><label for="receipt-2">OCR extracts store/date/price when possible</label></li>
              <li class="checklist-item"><input type="checkbox" id="receipt-3"><label for="receipt-3">Auto-fill from receipt fills only empty fields (no overwrites)</label></li>
              <li class="checklist-item"><input type="checkbox" id="receipt-4"><label for="receipt-4">Thumbnail priority shows product photo first (not receipt)</label></li>
            </ul>
          </div>

          <div class="subsection">
            <h4>üì∏ Photo Quality Checks</h4>
            <ul class="checklist">
              <li class="checklist-item"><input type="checkbox" id="photoq-1"><label for="photoq-1">Warnings appear for blurry/low-light/small-text photos</label></li>
              <li class="checklist-item"><input type="checkbox" id="photoq-2"><label for="photoq-2">Guidance feels accurate and helpful</label></li>
              <li class="checklist-item"><input type="checkbox" id="photoq-3"><label for="photoq-3">OCR/identification success improves with better photos</label></li>
            </ul>
          </div>
        </div>
      </section>

      <!-- System Integration -->
      <section class="section collapsed" id="system-integration" data-section="system-integration">
        <div class="section-header" onclick="toggleSection(this.parentElement)" tabindex="0" role="button" aria-expanded="false">
          <div class="section-icon">üîó</div>
          <h3>System Integration</h3>
          <span class="section-progress">0/0</span>
          <div class="section-toggle">‚ñº</div>
        </div>
        <div class="section-content">
          <ul class="checklist">
            <li class="checklist-item"><input type="checkbox" id="sys-1"><label for="sys-1">Spotlight search finds items (if supported)</label></li>
            <li class="checklist-item"><input type="checkbox" id="sys-2"><label for="sys-2">Handoff works between devices (if supported)</label></li>
            <li class="checklist-item"><input type="checkbox" id="sys-3"><label for="sys-3">Widgets display correctly (if supported)</label></li>
            <li class="checklist-item"><input type="checkbox" id="sys-4"><label for="sys-4">iCloud sync works as expected</label></li>
          </ul>
        </div>
      </section>

      <!-- Accessibility -->
      <section class="section collapsed" id="accessibility" data-section="accessibility">
        <div class="section-header" onclick="toggleSection(this.parentElement)" tabindex="0" role="button" aria-expanded="false">
          <div class="section-icon">‚ôø</div>
          <h3>Accessibility</h3>
          <span class="section-progress">0/0</span>
          <div class="section-toggle">‚ñº</div>
        </div>
        <div class="section-content">
          <ul class="checklist">
            <li class="checklist-item"><input type="checkbox" id="a11y-1"><label for="a11y-1">VoiceOver reads key UI elements clearly</label></li>
            <li class="checklist-item"><input type="checkbox" id="a11y-2"><label for="a11y-2">Dynamic Type works at larger sizes</label></li>
            <li class="checklist-item"><input type="checkbox" id="a11y-3"><label for="a11y-3">Keyboard navigation works (Mac/iPad)</label></li>
          </ul>

          <div class="subsection">
            <h4>Keyboard Shortcuts</h4>
            <table>
              <tr><th>Shortcut</th><th>Action</th></tr>
              <tr><td><kbd>‚åòN</kbd></td><td>Add Item</td></tr>
              <tr><td><kbd>‚åòK</kbd></td><td>Quick Find</td></tr>
              <tr><td><kbd>‚åò,</kbd></td><td>Settings</td></tr>
            </table>
          </div>
        </div>
      </section>

      <!-- iPad & Mac -->
      <section class="section collapsed" id="ipad-mac" data-section="ipad-mac">
        <div class="section-header" onclick="toggleSection(this.parentElement)" tabindex="0" role="button" aria-expanded="false">
          <div class="section-icon">üíª</div>
          <h3>iPad & Mac</h3>
          <span class="section-progress">0/0</span>
          <div class="section-toggle">‚ñº</div>
        </div>
        <div class="section-content">
          <ul class="checklist">
            <li class="checklist-item"><input type="checkbox" id="ipad-1"><label for="ipad-1">Split View layout works on iPad</label></li>
            <li class="checklist-item"><input type="checkbox" id="ipad-2"><label for="ipad-2">Stage Manager compatibility feels solid</label></li>
            <li class="checklist-item"><input type="checkbox" id="ipad-3"><label for="ipad-3">Trackpad/mouse behaviors feel correct</label></li>
            <li class="checklist-item"><input type="checkbox" id="ipad-4"><label for="ipad-4">macOS menu/shortcuts work as expected</label></li>
          </ul>
        </div>
      </section>
    </div>

    <div class="thank-you-card">
      <h2>Thank You!</h2>
      <p>Your feedback helps make Stuffolio better for everyone.<br />We truly appreciate your time.</p>
    </div>

    <footer>
      <p>Beta Testing Guide v1.1 ‚Äî Last Updated January 22, 2026 (Build 18)</p>
      <div style="display:flex;gap:16px;justify-content:center;flex-wrap:wrap;margin-top:12px;">
        <a href="index.html" style="color:var(--primary);text-decoration:none;">Home</a>
        <a href="quick-start.html" style="color:var(--primary);text-decoration:none;">Quick Start</a>
        <a href="features.html" style="color:var(--primary);text-decoration:none;">Features</a>
        <a href="support.html" style="color:var(--primary);text-decoration:none;">Support</a>
        <a href="privacy.html" style="color:var(--primary);text-decoration:none;">Privacy</a>
      </div>
      <p style="margin-top:12px;font-size:.8em;">¬© 2026 Coffee &amp; Code LLC</p>
    </footer>
  </main>

  <script>
    // ---------- Theme ----------
    const root = document.documentElement;
    const themeSwitch = document.getElementById('themeSwitch');

    function applyTheme(theme) {
      if (theme === 'dark') {
        root.setAttribute('data-theme', 'dark');
        themeSwitch.classList.add('dark');
        themeSwitch.setAttribute('aria-checked', 'true');
      } else if (theme === 'light') {
        root.setAttribute('data-theme', 'light');
        themeSwitch.classList.remove('dark');
        themeSwitch.setAttribute('aria-checked', 'false');
      } else {
        root.removeAttribute('data-theme');
        themeSwitch.classList.remove('dark');
        themeSwitch.setAttribute('aria-checked', 'false');
      }
    }

    function toggleTheme() {
      const current = localStorage.getItem('stuffolio_theme') || 'auto';
      const next = current === 'auto' ? 'dark' : current === 'dark' ? 'light' : 'auto';
      localStorage.setItem('stuffolio_theme', next);
      applyTheme(next === 'auto' ? null : next);
    }

    themeSwitch.addEventListener('click', toggleTheme);
    themeSwitch.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        toggleTheme();
      }
    });

    // init theme
    const savedTheme = localStorage.getItem('stuffolio_theme') || 'auto';
    applyTheme(savedTheme === 'auto' ? null : savedTheme);

    // ---------- Feedback helpers ----------
    function showTestFlightTip() {
      const tip = document.getElementById('testflightTip');
      tip.style.display = (tip.style.display === 'none' || tip.style.display === '') ? 'block' : 'none';
    }

    function copyTemplate() {
      const box = document.getElementById('templateBox');
      box.style.display = 'block';
      box.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }

    async function copyToClipboard() {
      const text = document.getElementById('templateContent').innerText;
      const btn = document.getElementById('copyBtn');
      try {
        await navigator.clipboard.writeText(text);
        btn.classList.add('copied');
        btn.textContent = 'Copied!';
        setTimeout(() => {
          btn.classList.remove('copied');
          btn.textContent = 'Copy to Clipboard';
        }, 1500);
      } catch (e) {
        alert('Copy failed. You can manually select and copy the template text.');
      }
    }

    // Make the clickable feedback "div buttons" keyboard-activatable
    document.querySelectorAll('.feedback-option[role="button"]').forEach(el => {
      el.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          el.click();
        }
      });
    });

    // ---------- Expand checklist ----------
    function toggleFullChecklist() {
      const full = document.getElementById('fullChecklist');
      const btn = document.getElementById('expandBtn');
      const isVisible = full.classList.toggle('visible');
      btn.classList.toggle('expanded', isVisible);
      btn.querySelector('span').textContent = isVisible ? 'Hide Complete Checklist' : 'Show Complete Checklist';
      if (isVisible) {
        full.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    }

    // ---------- Collapsible sections ----------
    function toggleSection(sectionEl) {
      const header = sectionEl.querySelector('.section-header');
      const isCollapsed = sectionEl.classList.toggle('collapsed');
      if (header) header.setAttribute('aria-expanded', String(!isCollapsed));
      saveSectionState(sectionEl);
    }

    // Let section headers toggle with keyboard
    document.querySelectorAll('.section .section-header').forEach(h => {
      h.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          toggleSection(h.parentElement);
        }
      });
    });

    // ---------- Progress + persistence ----------
    const STORAGE_KEY_CHECKS = 'stuffolio_beta_checks_v18';
    const STORAGE_KEY_SECTIONS = 'stuffolio_beta_sections_v18';

    function loadState() {
      try {
        return {
          checks: JSON.parse(localStorage.getItem(STORAGE_KEY_CHECKS) || '{}'),
          sections: JSON.parse(localStorage.getItem(STORAGE_KEY_SECTIONS) || '{}')
        };
      } catch {
        return { checks: {}, sections: {} };
      }
    }

    function saveChecksState(state) {
      localStorage.setItem(STORAGE_KEY_CHECKS, JSON.stringify(state));
    }

    function saveSectionsState(state) {
      localStorage.setItem(STORAGE_KEY_SECTIONS, JSON.stringify(state));
    }

    function saveSectionState(sectionEl) {
      const { sections } = loadState();
      const key = sectionEl.getAttribute('data-section') || sectionEl.id;
      if (!key) return;
      sections[key] = sectionEl.classList.contains('collapsed') ? 'collapsed' : 'expanded';
      saveSectionsState(sections);
    }

    function restoreSections() {
      const { sections } = loadState();
      document.querySelectorAll('.section[data-section]').forEach(section => {
        const key = section.getAttribute('data-section');
        const desired = sections[key];
        if (!desired) return;
        const header = section.querySelector('.section-header');
        if (desired === 'collapsed') {
          section.classList.add('collapsed');
          if (header) header.setAttribute('aria-expanded', 'false');
        } else {
          section.classList.remove('collapsed');
          if (header) header.setAttribute('aria-expanded', 'true');
        }
      });
    }

    function setChecklistItemVisual(checkbox) {
      const li = checkbox.closest('.checklist-item');
      if (!li) return;
      li.classList.toggle('checked', checkbox.checked);
    }

    function restoreCheckboxes() {
      const { checks } = loadState();
      document.querySelectorAll('.checklist input[type="checkbox"]').forEach(cb => {
        const saved = checks[cb.id];
        cb.checked = !!saved;
        setChecklistItemVisual(cb);
      });
    }

    function onCheckboxChange(e) {
      const cb = e.target;
      if (!cb || !cb.id) return;

      const { checks } = loadState();
      checks[cb.id] = cb.checked ? 1 : 0;
      saveChecksState(checks);
      setChecklistItemVisual(cb);

      updateAllProgress();
    }

    function bindCheckboxes() {
      document.querySelectorAll('.checklist input[type="checkbox"]').forEach(cb => {
        cb.addEventListener('change', onCheckboxChange);
      });
    }

    function computeTotals(scopeEl) {
      const boxes = Array.from(scopeEl.querySelectorAll('input[type="checkbox"]'));
      const total = boxes.length;
      const done = boxes.filter(b => b.checked).length;
      return { total, done };
    }

    function updateSectionProgress(sectionEl) {
      const badge = sectionEl.querySelector('.section-progress');
      if (!badge) return;

      const { total, done } = computeTotals(sectionEl);
      badge.textContent = `${done}/${total}`;

      badge.classList.toggle('complete', total > 0 && done === total);
    }

    function updateGlobalProgress() {
      const progressText = document.getElementById('progressText');
      const progressPercent = document.getElementById('progressPercent');
      const progressBar = document.getElementById('progressBar');

      const scope = document.getElementById('fullChecklist');
      if (!scope) return;

      const { total, done } = computeTotals(scope);
      const pct = total === 0 ? 0 : Math.round((done / total) * 100);

      if (progressText) progressText.textContent = `${done} of ${total} items completed`;
      if (progressPercent) progressPercent.textContent = `${pct}%`;
      if (progressBar) progressBar.style.width = `${pct}%`;
    }

    function updateAllProgress() {
      document.querySelectorAll('.section').forEach(updateSectionProgress);
      updateGlobalProgress();
    }

    function resetProgress() {
      if (!confirm('Reset your checklist progress on this device/browser?')) return;

      localStorage.removeItem(STORAGE_KEY_CHECKS);
      document.querySelectorAll('.checklist input[type="checkbox"]').forEach(cb => {
        cb.checked = false;
        setChecklistItemVisual(cb);
      });

      updateAllProgress();
    }

    // ---------- Init ----------
    (function init() {
      restoreSections();
      restoreCheckboxes();
      bindCheckboxes();
      updateAllProgress();
    })();
  </script>
</body>
</html>
